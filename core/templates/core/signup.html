{% extends 'core/base.html' %}
{% block title %}Sign In / Sign Up{% endblock %}

{% block content %}

{% if messages %}
    {% for message in messages %}
        <div style="
            background-color:{% if message.tags == 'error' %}#f8d7da{% elif message.tags == 'success' %}#d4edda{% else %}#fff3cd{% endif %};
            color:{% if message.tags == 'error' %}#842029{% elif message.tags == 'success' %}#155724{% else %}#856404{% endif %};
            padding:12px;
            margin-bottom:12px;
            border-radius:6px;
            font-weight:600;
            border:1px solid {% if message.tags == 'error' %}#f5c2c7{% elif message.tags == 'success' %}#c3e6cb{% else %}#ffeeba{% endif %};
        ">
            {{ message }}
        </div>
    {% endfor %}
{% endif %}

<div style="display:flex; flex-wrap:wrap; min-height:80vh; max-width:900px; margin:50px auto; border-radius:12px; overflow:hidden; box-shadow:0 8px 20px rgba(0,0,0,0.2);">

    <!-- Left side image -->
    <div style="flex:1; min-width:300px; position:relative; background-image:url('/static/images/login.png'); background-size:cover; background-position:center; display:flex; align-items:center; justify-content:center;">
        <div style="position:absolute; top:0; left:0; width:100%; height:100%; background-color:rgba(0,0,0,0.5);"></div>
        <div style="position:relative; color:white; text-align:center; padding:30px;">
            <h2 style="font-size:2.2rem; margin-bottom:20px;">Welcome!</h2>
            <p style="font-size:1rem; line-height:1.6; max-width:280px; margin:0 auto;">
                Create your account or sign in to access our amazing services.
            </p>
        </div>
    </div>

    <!-- Right side forms -->
    <div style="flex:1; min-width:300px; padding:40px; background-color:white; display:flex; flex-direction:column; justify-content:center;">

        <!-- SIGNUP FORM (Default Visible) -->
        <div id="signupForm" style="display:block;">
            <h2 style="text-align:center; margin-bottom:25px; color:#333; font-weight:700;">Sign Up</h2>

            <form method="POST" action="{% url 'signup' %}">
                {% csrf_token %}
                <div style="margin-bottom:15px;">
                    <label style="font-weight:600; margin-bottom:5px; display:block;">Username</label>
                    <input type="text" name="username" value="{{ username|default:'' }}" required 
                        style="width:100%; padding:12px; border-radius:8px; border:1px solid #ccc; font-size:1rem;">
                </div>

                <div style="margin-bottom:15px;">
                    <label style="font-weight:600; margin-bottom:5px; display:block;">Email</label>
                    <input type="email" name="email" value="{{ email|default:'' }}" required
                        style="width:100%; padding:12px; border-radius:8px; border:1px solid #ccc; font-size:1rem;">
                </div>

                <div style="margin-bottom:15px;">
                    <label style="font-weight:600; margin-bottom:5px; display:block;">Password</label>
                    <input type="password" name="password1" required
                        style="width:100%; padding:12px; border-radius:8px; border:1px solid #ccc; font-size:1rem;">
                </div>

                <div style="margin-bottom:15px;">
                    <label style="font-weight:600; margin-bottom:5px; display:block;">Confirm Password</label>
                    <input type="password" name="password2" required
                        style="width:100%; padding:12px; border-radius:8px; border:1px solid #ccc; font-size:1rem;">
                </div>

                <button type="submit" style="width:100%; padding:14px; background-color:#f0a500; color:white; border:none; border-radius:8px; font-weight:700; font-size:1rem; cursor:pointer;">
                    Sign Up
                </button>

                <div style="text-align:center; margin-top:15px;">
                    <button type="button" id="showSignin" 
                            style="background:none; border:none; color:#28a745; font-weight:700; cursor:pointer; font-size:0.95rem;">
                        Already have an account? Sign In
                    </button>
                </div>
            </form>
        </div>

        <!-- SIGNIN FORM -->
        <div id="signinForm" style="display:none;">
            <h2 style="text-align:center; margin-bottom:25px; color:#333; font-weight:700;">Welcome Back ðŸ‘‹</h2>

            {% if login_errors %}
                <div style="
                    background-color:#f8d7da; 
                    color:#842029; 
                    padding:12px; 
                    margin-bottom:15px; 
                    border-radius:6px; 
                    font-weight:600; 
                    border:1px solid #f5c2c7;
                ">
                    {{ login_errors }}
                </div>
            {% endif %}

            <form method="POST" action="{% url 'login' %}" autocomplete="off" style="margin-top:10px;">
                {% csrf_token %}
                <div style="margin-bottom:20px;">
                    <label style="font-weight:600; margin-bottom:8px; display:block;">Email Address</label>
                    <input type="email" name="email" required autocomplete="off"
                           value="{{ email|default:'' }}"
                           style="width:100%; padding:14px; border-radius:10px; border:1px solid #ccc; font-size:1rem; transition:all 0.3s ease;">
                </div>

                <div style="margin-bottom:20px;">
                    <label style="font-weight:600; margin-bottom:8px; display:block;">Password</label>
                    <input type="password" name="password" required autocomplete="new-password"
                           style="width:100%; padding:14px; border-radius:10px; border:1px solid #ccc; font-size:1rem; transition:all 0.3s ease;">
                </div>

                <button type="submit" style="
                    width:100%; 
                    padding:14px; 
                    background:linear-gradient(135deg, #28a745, #218838); 
                    color:white; 
                    border:none; 
                    border-radius:10px; 
                    font-weight:700; 
                    font-size:1rem; 
                    cursor:pointer; 
                    box-shadow:0 4px 10px rgba(40,167,69,0.3);
                    transition:all 0.3s ease;">
                    Sign In
                </button>

                <button type="button" id="backToSignup" 
                        style="margin-top:15px; background:none; border:none; color:#f0a500; font-weight:700; cursor:pointer; font-size:0.95rem; display:block; text-align:center;">
                    Don't have an account? Sign Up
                </button>
            </form>
        </div>

    </div>
</div>

<script>
const showSigninBtn = document.getElementById('showSignin');
const backToSignupBtn = document.getElementById('backToSignup');
const signinForm = document.getElementById('signinForm');
const signupForm = document.getElementById('signupForm');

showSigninBtn?.addEventListener('click', () => {
    signupForm.style.display = 'none';
    signinForm.style.display = 'flex';
    signinForm.style.flexDirection = 'column';
});

backToSignupBtn?.addEventListener('click', () => {
    signinForm.style.display = 'none';
    signupForm.style.display = 'flex';
    signupForm.style.flexDirection = 'column';
});
</script>

{% endblock %}
